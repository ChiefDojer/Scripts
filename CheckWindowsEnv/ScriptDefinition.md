Windows Development Environment Check: Methodology (v2.8)This document explains the technical approach and specific commands used by the Checkin_Windows_Development_Environment.ps1 script (v2.8) to verify the installation and version of various development tools on a Windows system.The script primarily uses PowerShell and its robust error handling capabilities to ensure reliability, even when tools are missing or return unusual output.I. The Core Checking Function: Check-CommandThe vast majority of tool checks rely on a centralized function, Check-Command, designed for resilience and consistency.A. General ApproachStepActionDescription1. Execution& $cmd $arg 2>&1Executes the command ($cmd) with a standard argument (e.g., --version, -v, version). The crucial part is 2>&1, which redirects Standard Error (stderr) output into the Standard Output (stdout) stream. This is necessary because many tools (like psql or java) print version information to stderr.2. Exit Code Check$LASTEXITCODE -eq 0The check first verifies that the command executed successfully, usually indicated by an exit code of 0. (See Section II for exceptions).3. Output Cleaning$output -split '\r?\n' | Select-Object -First 1Cleans up the raw output, taking only the first line and trimming surrounding whitespace, as version commands often return verbose, multi-line text.4. Version Extractionif ($Parser -ne "" -and $versionString -match $Parser)An optional Regular Expression ($Parser) can be supplied to extract a specific part (e.g., only the version number) if the output is inconsistent.5. ReportingWrite-Host and $resultsRecords the tool name and the cleaned version string into the global $results hash table for the final summary.B. Command ExamplesTool NameCommand UsedArgumentNotesGitgit--versionStandard version command.Pythonpython--versionStandard version command.Node.jsnode-vUses the short form for Node.Java JREjava-versionThis command typically outputs to stderr, making the 2>&1 redirection essential for capture.GogoversionReturns a simple string like go version go1.21.0 windows/amd64.Docker Composedocker composeversionChecks for the modern plugin (using docker compose) first, then falls back to the legacy docker-compose if needed.II. Dedicated Checks for Non-Standard ToolsSome tools cannot be reliably checked using Check-Command due to graphical windows, non-standard exit codes, or complex installation methods. These tools have custom, robust logic implemented outside the main function.A. Visual Studio (devenv.exe)Problem: Running devenv.exe /? or a similar argument causes Visual Studio to open a graphical help window, interrupting the script's silent execution.Approach: The script avoids running the executable entirely for version information.It searches the standard installation path (C:\Program Files\Microsoft Visual Studio) recursively to find the latest devenv.exe file.It uses the PowerShell command Get-Item $fullPath | Select-Object -ExpandProperty VersionInfo to read the product version directly from the file's metadata (the same information you see in file properties in Explorer), preventing the window from appearing.B. 7-Zip (7z.exe)Problem: The 7z command often returns a non-zero exit code (e.g., 2) when run without arguments, even though it successfully prints version/usage information. This causes Check-Command to fail the $LASTEXITCODE -eq 0 check.Approach:The script first checks if 7z.exe is in the system PATH.If not, it performs a registry search under common keys (HKLM:\SOFTWARE\7-Zip, etc.) to find the installation folder and the full path to 7z.exe.It then executes the command but relies only on the successful capture of output (if ($output)), ignoring the non-zero exit code.C. PowerShell Console Title RestorationProblem: Some external executables, particularly batch files like npm.cmd, temporarily change the console window title during their execution (e.g., to "npm"). This title is sometimes not restored afterward.Approach:At the start of the script, the current title is saved: $originalTitle = $Host.UI.RawUI.WindowTitle.The title is restored within a finally block at the end of the script: finally { $Host.UI.RawUI.WindowTitle = $originalTitle }. This guarantees the title is restored even if the script execution is stopped by an error.III. Verification of Environment StatusThe script performs additional, specific checks for critical environment capabilities:FeatureApproachCommand UsedWSL StatusChecks the output of the status command to see if a default distribution is configured.wsl --statusVirtualizationChecks if the Hyper-V or Virtual Machine Platform Windows Optional Feature is enabled, which is required for tools like Docker Desktop. (Requires elevated rights to run, so it handles errors gracefully).Get-WindowsOptionalFeature -Online -FeatureName '...'Python venvAttempts to create a dummy virtual environment (testenv) to confirm that the venv module is installed and functional, then immediately cleans it up.python -m venv testenv